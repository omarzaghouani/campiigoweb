{% extends 'base.html.twig' %}

{% block title %}
    <title>Activite</title>
{% endblock %}

{% block body %}
<div class="table_centre-container">
    <div>
        <form action="{{ path('user_index') }}" method="GET">
            <input type="text" name="nom" id="search-input" placeholder="Rechercher" class="input">
        </form>
    </div>
    <table class="centre-table">
        <thead>
           <tr>
    <th>Id</th>
    <th>
        <a href="{{ path('user_index', {'sort': 'asc', 'attribute': 'nom'}) }}">Nom ▲</a> / 
        <a href="{{ path('user_index', {'sort': 'desc', 'attribute': 'nom'}) }}">Nom ▼</a>
    </th>

    <th>photo</th>
    <th>
        <a href="{{ path('user_index', {'sort': 'asc', 'attribute': 'prenom'}) }}">Prenom ▲</a> / 
        <a href="{{ path('user_index', {'sort': 'desc', 'attribute': 'prenom'}) }}">Prenom ▼</a>
    </th>
    <th>
        <a href="{{ path('user_index', {'sort': 'asc', 'attribute': 'numTel'}) }}">numTel ▲</a> / 
        <a href="{{ path('user_index', {'sort': 'desc', 'attribute': 'numTel'}) }}">numTel ▼</a>
    </th>
    <th>
        <a href="{{ path('user_index', {'sort': 'asc', 'attribute': 'email'}) }}">Email ▲</a> / 
        <a href="{{ path('user_index', {'sort': 'desc', 'attribute': 'email'}) }}">Email ▼</a>
    </th>
    <th>
        <a href="{{ path('user_index', {'sort': 'asc', 'attribute': 'role'}) }}">Role ▲</a> / 
        <a href="{{ path('user_index', {'sort': 'desc', 'attribute': 'role'}) }}">Role ▼</a>
    </th>
    <th>
        <a href="{{ path('user_index', {'sort': 'asc', 'attribute': 'actif'}) }}">Actif ▲</a> / 
        <a href="{{ path('user_index', {'sort': 'desc', 'attribute': 'actif'}) }}">Actif ▼</a>
    </th>
    <th>Actions</th>
</tr>
        </thead>
        <tbody >
            {% for utilisateur in u %}
                <tr class="activite-row">
                    <td>{{ utilisateur.id }}</td>
                    <td class="nom">{{ utilisateur.Nom }}</td>
                    <td><img src="{{ asset('uploads/' ~ utilisateur.getPhotoD) }}" alt="Photo du centre" class="centre-photo" width="100" height="100"></td>
                    <td>{{ utilisateur.Prenom }}</td>
                    <td>{{ utilisateur.numerodetelephone }}</td>
                    <td>{{ utilisateur.email }}</td>
                    <td>{{ utilisateur.role }}</td>
                    <td>{{ utilisateur.actif }}</td>
                    <td>
                        <a href="{{ path('user_show', {'id': utilisateur.id}) }}" class="btn btn-primary">Voir</a>
                        <a href="{{ path('modifier', {'id': utilisateur.id}) }}" class="btn btn-secondary">Éditer</a>
                        <form method="post" action="{{ path('delete', {'id': utilisateur.id}) }}" class="d-inline">
                            <input type="hidden" name="_method" value="DELETE">
                            <button type="submit" class="btn btn-danger" onclick="return confirm('Êtes-vous sûr de vouloir supprimer cet utilisateur ?')">Supprimer</button>
                             <a href="{{ path('utilisateur_stat') }}" class="btn ">Statistiques</a>
                        </form>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
    <div>
                  <a href="{{ path('signin') }}" class="btn btn-large">Ajouter</a>
                   </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
    $(document).ready(function() {
     $('#search-input').on('input', function() {
        const searchTerm = $(this).val().toLowerCase();
        $('.activite-row').each(function() {
            const nom = $(this).find('.nom').text().toLowerCase();
            if (nom.includes(searchTerm)) {
                $(this).show();
            } else {
                $(this).hide();
            }
        });
    });
});

    </script>
{% endblock %}
